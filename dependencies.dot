// The string "//T" is used to mark and disable dependencies satisfied
// through transitive dependencies. This cleans up the graph a bit.
//
// Similarly the string "//G" marks and disables dependencies of
// packages used pretty much everywhere and as such strongly cluttering
// the graph.

strict digraph {
	//	Frontend
	core		[shape="diamond"];

	//	Backend (External CC)
	cc		[shape="hexagon"];

	//	Application
	app		[shape="circle"];

	//	Stateless functionality.
	common		[];				// Critcl specific general utilities
	//	Only transient state during operation.
	scan		[];				// Static scanner of .(cri)tcl files

	//	File container
	data		[shape="triangle"];		// Container for template and other data files

	//	System state (in-memory databases)
	api		[shape="box"];			// Management of stubs tables, i.e. package APIs
	at		[shape="box"];			// Management of #line information in generated code
	cache		[shape="box"];			// Management of the result cache (directory)
	ccconfig	[shape="box"];			// Configuration information for external CC, multi-platform
	cdefs		[shape="box"];			// Management of the collected C definitions.
	gopt		[shape="box"];			// Global option management
	log		[shape="box"];			// Log file handling
	meta		[shape="box"];			// Management of TEApot meta data
	tags		[shape="box"];			// Management of general indicator flags
	typeconv	[shape="box"];			// Management of type conversions (args, results) for cproc
	usrconfig	[shape="box"];			// Management of user-specified configuration options
	uuid		[shape="box"];			// Code hashes for change detection.
	who		[shape="box"];			// Management of the "current" file.

	//	Dependencies
	//	A -> B   <==> A is-used-by B

	at		->	typeconv;
	//T cache		->	api;
	cache		->	ccconfig;
	cache		->	cdefs;
	cache		->	log;
	cdefs		->	api;
	cdefs		->	usrconfig;
	//G common		->	api;
	//G common		->	cache;
	//G common		->	ccconfig;
	//G common		->	cdefs;
	//G common		->	log;
	//G common		->	meta;
	//G common		->	scan;
	data		->	common;
	data		->	cdefs;
	gopt		->	at;
	gopt		->	cdefs;
	//T meta		->	api;
	meta		->	cdefs;
	meta		->	scan;
	scan		->	cdefs;
	//T tags		->	api;
	tags		->	cdefs;
	//T uuid		->	api;
	uuid		->	cdefs;
	//T uuid		->	usrconfig;
	who		->	at;

	//T cache		->	cc;
	ccconfig	->	cc;
	cdefs		->	cc;
	//G common		->	cc;
	//T data		->	cc;
	//T gopt		->	cc;
	log		->	cc;
	//T tags		->	cc;

	api		->	core;
	at		->	core;
	//T cache		->	core;
	cc		->	core;
	cdefs		->	core;
	//G common		->	core;
	//T data		->	core;	// for CollectEmbedded only.
	//T gopt		->	core;
	//T meta		->	core;
	//T tags		->	core;
	typeconv	->	core;
	usrconfig	->	core;
	//T uuid		->	core;
	//T who		->	core;


	// Application linkage
	core	->	app;
	cdefs	->	app;
	meta	->	app;
	tags	->	app;
}
